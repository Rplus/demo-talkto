{"version":3,"sources":["app.js"],"names":["_typeof","obj","Symbol","constructor","$","slider","elm","length","main","find","content","len","bgiUpdated","css","updateBgi","_order","getSibling","indexOf","_target","eq","bgi","replace","push","ajaxSetup","cache","getScript","data","textStatus","thumb","btnTmpl","html","initOrder","slick","arrows","asNavFor","fade","initialSlide","slidesToShow","on","event","currentSlide","nextSlide","centerMode","centerPadding","focusOnSelect","useTransform","prevArrow","outerHTML","nextArrow","responsive","breakpoint","settings","titles","each","index","val","txt","textContent","innerHTML","slice","polis","items","domPrefixes","split","document","createElement","undefined","style","animationName","isSupportAnimation","i","documentElement","addClass","more","step","loadmore","_top10","preventDefault","off","hide","click","video","_ret","player","iframe","_vid","_config","enablejsapi","html5","showinfo","autoplay","_url","param","attr","onPlayerReady","playVideo","onPlayerStateChange","window","onYouTubePlayerAPIReady","YT","Player","events","onReady","onStateChange","v","now","Date","getConfirm","confirm","confirmTime","localStorage","getItem","deltaTime","removeItem","setItem","location","href"],"mappings":"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","file":"app.js","sourcesContent":["/*global $, YT, localStorage, location */\n\n'use strict';\n\n$(function () {\n  let slider = {\n    elm: $('.slider')\n  };\n\n  if (slider.elm.length) {\n    slider.main = slider.elm.find('.slider-body');\n    slider.content = slider.main.find('.slider-content');\n    slider.len = slider.content.length;\n    slider.bgiUpdated = [];\n\n    // for some broken browser doesn't support `vh` well\n    slider.main.css('height', slider.main.css('height'));\n\n    slider.updateBgi = (_order, getSibling) => {\n      if (slider.bgiUpdated.indexOf(_order) === -1) {\n        let _target = slider.content.eq(_order);\n        let bgi = _target.css('background-image');\n\n        bgi = `${bgi.replace('thumb', 'bg')}, ${bgi}`;\n        _target.css('background-image', bgi);\n        slider.bgiUpdated.push(_order);\n      }\n\n      if (getSibling) {\n        slider.updateBgi((_order + slider.len - 1) % slider.len);\n        slider.updateBgi((_order + 1) % slider.len);\n      }\n    };\n\n    $.ajaxSetup({ cache: true });\n    $.getScript('https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.5.9/slick.min.js', (data, textStatus) => {\n      slider.thumb = slider.elm.find('.slider-thumbs');\n      slider.btnTmpl = $('<div />').html($('#slider-btn-tmpl').html()).find('button');\n      slider.initOrder = slider.len - 1;\n\n      slider.updateBgi(slider.initOrder, true);\n\n      slider.main.slick({\n        arrows: false,\n        asNavFor: slider.thumb,\n        fade: true,\n        initialSlide: slider.initOrder,\n        slidesToShow: 1\n      });\n\n      slider.main.on('beforeChange', (event, slick, currentSlide, nextSlide) => {\n        slider.updateBgi(nextSlide, true);\n      });\n\n      slider.thumb.slick({\n        asNavFor: slider.main,\n        centerMode: true,\n        centerPadding: 0,\n        focusOnSelect: true,\n        initialSlide: slider.initOrder,\n        slidesToShow: 5,\n        useTransform: true,\n        prevArrow: slider.btnTmpl[0].outerHTML,\n        nextArrow: slider.btnTmpl[1].outerHTML,\n        responsive: [\n          {\n            breakpoint: 769,\n            settings: {\n              slidesToShow: 3\n            }\n          }\n        ]\n      });\n    });\n    $.ajaxSetup({ cache: false });\n  }\n\n  // simple macho effect for CJK text wrapping\n  let titles = $('.title, .talk__title, .point-item__title');\n  if (titles.length) {\n    $.each(titles, (index, val) => {\n      let txt = val.textContent;\n      if (txt.length > 3) {\n        val.innerHTML = `${txt.slice(0, -3)}<span class=\"ib\">${txt.slice(-3)}</span>`;\n      }\n    });\n  }\n\n  // polis step show\n  let polis = {\n    items: $('.polis')\n  };\n\n  if (polis.items.length) {\n    // detect animation support\n    (function () {\n      let domPrefixes = 'Webkit Moz O ms Khtml'.split(' ');\n      let elm = document.createElement('div');\n\n      if (elm.style.animationName !== undefined) {\n        polis.isSupportAnimation = true;\n        return;\n      }\n\n      if (!polis.isSupportAnimation) {\n        for (let i = 0; i < domPrefixes.length; i++) {\n          if (elm.style[ domPrefixes[i] + 'AnimationName' ] !== undefined) {\n            polis.isSupportAnimation = true;\n            break;\n          }\n        }\n      }\n    })();\n\n    if (!polis.isSupportAnimation) {\n      $(document.documentElement).addClass('no-animation');\n    }\n\n    polis.more = $('.polis-more');\n    polis.step = polis.more.data('slice');\n\n    polis.loadmore = () => {\n      let _top10 = polis.items.slice(0, polis.step);\n      polis.items = polis.items.slice(polis.step);\n      _top10.addClass('is-show');\n    };\n\n    polis.more.on('click.loadmore', (event) => {\n      event.preventDefault();\n      polis.loadmore();\n\n      // remove click event & loadmore\n      if (!polis.items.length) {\n        polis.more.off('click.loadmore').hide();\n      }\n    });\n\n    polis.more.click();\n  }\n\n  // video\n  let video = {\n    elm: $('.video')\n  };\n\n  if (video.elm.length) {\n    let player;\n    video.iframe = video.elm.find('.video-iframe');\n\n    if (!video.iframe.length) { return; }\n\n    video.elm.find('.video-cover').on('click.loadvideo', () => {\n      let _vid = video.iframe.data('vid');\n      let _config = {\n        enablejsapi: 1,\n        html5: 1,\n        showinfo: 0,\n        autoplay: 1\n      };\n      let _url = `https://www.youtube.com/embed/${_vid}?${$.param(_config)}`;\n      video.iframe.attr('src', _url);\n      video.elm.addClass('video-playing');\n    });\n\n    video.onPlayerReady = () => {\n      $('.video-cover__icon-play').on('click.playvideo', () => {\n        player.playVideo();\n      });\n    };\n\n    video.onPlayerStateChange = (event) => {\n      if (event.data === 1) {\n        video.elm.addClass('video-playing');\n      }\n    };\n\n    $.ajaxSetup({ cache: true });\n    $.getScript('//www.youtube.com/player_api', (data, textStatus) => {\n      window.onYouTubePlayerAPIReady = () => {\n        player = new YT.Player('video', {\n          events: {\n            'onReady': video.onPlayerReady,\n            'onStateChange': video.onPlayerStateChange\n          }\n        });\n      };\n    });\n    $.ajaxSetup({ cache: false });\n  }\n});\n\n$(window).on('load', () => {\n  let now = +new Date();\n  let getConfirm = () => {\n    return window.confirm('這是個人練習 jade 的作品，\\n圖文資料等皆取自政問原始網站 talkto.tw，\\n理解的話請按確定，並繼續瀏覽~');\n  };\n  let confirmTime = localStorage && localStorage.getItem('confirmTime');\n\n  if (!confirmTime) {\n    if (getConfirm()) {\n      localStorage.setItem('confirmTime', now);\n    } else {\n      // redirect to github repo\n      location.href = 'https://github.com/Rplus/demo-talkto';\n    }\n  } else {\n    // outdated: over 30 mins, remove confirmTime\n    let deltaTime = now - confirmTime * 1;\n    if (deltaTime > 30 * 60 * 1000) {\n      localStorage.removeItem('confirmTime');\n    }\n  }\n});\n"],"sourceRoot":"/source/"}